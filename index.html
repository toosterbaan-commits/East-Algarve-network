<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verhuurders Netwerk Oost-Algarve</title>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    
    <style>
        /* ... (Alle CSS van de <style> sectie hier plaatsen) ... */
        
        /* Voeg deze nieuwe CSS toe */
        #Auth {
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        /* ... (De rest van je bestaande CSS) ... */
    </style>
</head>
<body>

    <section id="Auth" class="module actief">
        <div class="auth-container">
            <h1>Welkom Terug bij het Netwerk</h1>

            <form id="registratie-formulier" onsubmit="registreerGebruiker(event)"> 
                <h2>Nieuw Account</h2>
                <input type="text" id="reg-naam" placeholder="Bedrijfsnaam / Naam" required>
                <input type="email" id="reg-email" placeholder="E-mailadres" required>
                <input type="password" id="reg-wachtwoord" placeholder="Wachtwoord" required>
                <button type="submit" class="knop-primair">Registreren</button>
                <p>Al een account? <a href="#" onclick="toonLogin()">Log hier in</a></p>
            </form>

            <hr>

            <form id="login-formulier" style="display: none;" onsubmit="logInGebruiker(event)">
                <h2>Inloggen</h2>
                <input type="email" id="login-email" placeholder="E-mailadres" required>
                <input type="password" id="login-wachtwoord" placeholder="Wachtwoord" required>
                <button type="submit" class="knop-primair">Inloggen</button>
                <p>Nog geen account? <a href="#" onclick="toonRegistratie()">Registreer hier</a></p>
            </form>
        </div>
    </section>

    <section id="Welkomst" class="module" style="display: none;">
        </section>

    <main id="app-container" style="display: none;">
        </main>

    <nav id="nav-bar" style="display: none;">
        </nav>
    
    <script>
        // ========= FIREBASE INITIALISATIE (Met jouw unieke config) =========
        const firebaseConfig = {
          apiKey: "AIzaSyD8X8zLlVEbCJsk_T7IgwGvjpMk39GjxVU",
          authDomain: "oost-algarve-network.firebaseapp.com",
          projectId: "oost-algarve-network",
          storageBucket: "oost-algarve-network.firebasestorage.app",
          messagingSenderId: "905979737722",
          appId: "1:905979737722:web:a7df5a062f7f058c3b2dc3"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();     
        const db = firebase.firestore(); 

        // === ALGEMEEN NAVIGATIE FRAMEWORK ===
        function verbergAlles() {
            // ... (Bestand: Verbergt Auth, Welkomst, App Container, Navigatie) ...
        }
        function startApp(uid) {
            // ... (Bestand: Toont App Container en Navigatie) ...
        }
        function toonLogin() {
            // ... (Bestand: Wisselt Auth schermen) ...
        }
        function toonRegistratie() {
            // ... (Bestand: Wisselt Auth schermen) ...
        }
        function wisselModule(moduleId) {
            // ... (Bestand: Wisselt tussen app modules) ...
        }

        // === AUTHENTICATIE LOGICA (Jouw functies) ===
        function registreerGebruiker(event) {
            event.preventDefault(); // Dit moet de pagina reload stoppen!
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-wachtwoord').value;
            const naam = document.getElementById('reg-naam').value;

            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    // Profiel opslaan in Firestore
                    return db.collection("gebruikers").doc(user.uid).set({
                        Naam: naam,
                        Email: email,
                        Rol: "Verhuurder",
                        Status_Verificatie: "Niet Verstuurd",
                        Locatie_Focus: "Nog In Te Vullen",
                        Telefoon_Publiek: false
                    });
                })
                .then(() => {
                    alert("Registratie succesvol! Je bent nu ingelogd.");
                    startApp(); 
                })
                .catch((error) => {
                    alert("Fout bij registratie: " + error.message);
                });
        }

        function logInGebruiker(event) {
            event.preventDefault(); // Dit moet de pagina reload stoppen!
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-wachtwoord').value;

            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    alert("Succesvol ingelogd!");
                    // startApp() wordt automatisch aangeroepen door onAuthStateChanged
                })
                .catch((error) => {
                    alert("Fout bij inloggen: " + error.message);
                });
        }

        // === STARTUP CHECK ===
        auth.onAuthStateChanged(function(user) {
            verbergAlles();

            if (user) {
                // Gebruiker is ingelogd
                startApp(user.uid); 
            } else {
                // Gebruiker is NIET ingelogd
                document.getElementById('Auth').style.display = 'block'; 
                toonRegistratie(); // Toon registratieformulier als standaard
            }
        });
        
        // ... (De rest van je prikbordLaden() en netwerkLaden() functies hier) ...
    </script>
</body>
</html>
